package main

import (
	_ "embed"
	"encoding/json"
	"fmt"
	"os"
	"strconv"
	"strings"
	"time"
)

//go:embed resources/output.html
var OutputHtml []byte

//go:embed resources/cytoscape.min.js
var CytoscapeJs []byte

//go:embed resources/index.html
var IndexHtml []byte
type NodeData struct {
	Id string `json:"id"`
	Image string `json:"image"`
	LocalImageLink string `json:"localImageLink"`
	Target string `json:"target,omitempty"`
	WikiLink string `json:"wikiLink,omitempty"`
	Source string `json:"source,omitempty"`
	Size string `json:"size,omitempty"`
}

type Node struct {
	Data NodeData `json:"data"`
	Group string `json:"group,omitempty"`
}

type OutputConfig struct {
	FileName string
	ImagesEnabled bool
}

func OutputTitle(s string) string {
	return strings.ReplaceAll(strings.ToUpper(string(s[0])) + strings.ToLower(s[1:]), "_", " ")
}

func GenerateOutput(dreams []Dream, connections []Connection, config OutputConfig) {
	outputData := []Node{}
	for _, dream := range dreams {
		if dream.Image == "" {
			dream.Image = "data:image/png;base64,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"
		}

		if !config.ImagesEnabled {
			dream.Image = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII="
		}

		size := "100"
		if dream.Center {
			size = "200"
		}
		outputData = append(outputData, Node{
			Data: NodeData{
				Id: OutputTitle(dream.Id),
				Image: dream.Image,
				LocalImageLink: dream.ImageHqLocalLink,
				Size: size,
				WikiLink: strings.Replace(*WikiBase, "%s", dream.Id, 1),
			},
			Group: "nodes",
		})
	}

	for _, connection := range connections {
		outputData = append(outputData, Node{
			Data: NodeData{
				Id: connection.FromID + "-" + connection.ToID,
				Source: OutputTitle(connection.FromID),
				Target: OutputTitle(connection.ToID),
				Size: "100",
			},
			Group: "edges",
		})
	}

	outputJson, err := json.Marshal(outputData)
	if err != nil {
		fmt.Println(Error, err)
		return
	}
	
	output := string(OutputHtml)
	output = strings.Replace(output, "$$NODES", string(outputJson), 1)
	output = strings.Replace(output, "$$CYTOSCAPE", string(CytoscapeJs), 1)
	
	err = os.WriteFile("./output/" + config.FileName, []byte(output), 0600)
	if err != nil {
		fmt.Println(Error, err)
		return
	}
}

func WriteIndexOutput() {
	date := strconv.Itoa(time.Now().Day()) + "/" + strconv.Itoa(int(time.Now().Month()))
	err := os.WriteFile("./output/index.html", []byte(strings.ReplaceAll(string(IndexHtml), "$DATE", date)) , 0600)
	if err != nil {
		fmt.Println(Error, err)
		return
	}
}